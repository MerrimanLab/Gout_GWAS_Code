################################################################################

# This directory contains the scripts for all the colocalisation analyses,
# including eQTL, meQTL, and urate colocalisation

################################################################################
# GTEx cis-eQTL colocalisation

# Code used for cis/trans-eQTL colocalisation were written by Murray Cadzow,
# Tanya Major, and Megan Leask

# GWAS = GWAS summary stats
# SNPLIST = list of lead SNPs (in column 1)
# WINDOW = window size (bp)
# CPU = number of cpus for the parallel tasks

bash colocalisation_scripts/eqtl/cis_eqtl/cis_eqtl_pipeline.sh GWAS SNPLIST WINDOW CPU quant

################################################################################
# GTEx trans-eQTL colocalisation

# Trans-eQTL is done in few steps:
# 1. Identify SNPs that need to be tested for trans-eQTL (?) - TODO: confirm with MEGAN
# 2. Send to Justin O'Sullivan and Tayaza Fadason for CoDeS3D analysis
# 3. TODO: part2

# GWAS = GWAS summary stats
# QTL =  Tab delimited file with rsid, gene symbol, and GTEx tissue columns
# WINDOW = window size (bp)
bash colocalisation_scripts/eqtl/trans_eqtl/trans_eqtl_pipeline_part1.sh GWAS QTL WINDOW

# Output of above script is sent off for CoDeS3D analysis

# Trans-eQTL colocalisation is run after the results come back from CoDeS3D
bash colocalisation_scripts/eqtl/trans_eqtl/trans_eqtl_pipeline_part2.sh

################################################################################
# GoDMC cis-meQTL colocalisation

# The script below runs the whole meQTL colocalisation analysis, given a list
# of CHR/BP
#
# General steps:
# 1. Figure out if there are any significant meQTL for a variant
# 2. Make sure the meQTLs from 1) are in cis and passes bonferroni correction
# 3. Pull out relevant summary stats from GWAS and meQTL data
# 4. Run colocalisation analysis
# 5. Combine the results
#
# INPUT = list of "CHR_BP"
# SEX = full, male, or female
# OUTDIR = the output directory where the results are written to
bash src/run_pipeline.sh INPUT SEX OUTDIR

################################################################################
# Tin + UKBB urate colocalisation

